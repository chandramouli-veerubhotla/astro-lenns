import{g as Z,o as J}from"./chunk-MD4LP4KJ.js";import{a as ce}from"./chunk-F65JCZTV.js";import"./chunk-3QBQF2XC.js";import{b as ee,e as te,f as ie,g as ne,j as oe,k as ae,m as re,n as se,p as le,q as me}from"./chunk-FJGIT65E.js";import{a as U,b as R,d as G}from"./chunk-P2OK47XY.js";import{J as K,a as W}from"./chunk-QX6YGPEV.js";import{$ as b,Da as l,Eb as T,Gb as o,Hb as V,Ib as C,Jb as Y,Qb as X,R as B,Ra as M,S as N,Sa as j,Sb as z,W as D,Wb as _,Zb as Q,a as S,aa as v,bb as u,cb as p,eb as H,fb as E,gb as I,hb as P,ib as m,jb as c,kb as O,lb as r,ma as y,mb as s,ob as x,qb as w,rb as g,rc as $,sb as h,sc as q}from"./chunk-BNPGFM2V.js";var de=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=j({type:n});static \u0275inj=N({imports:[R,J,K,Z]})}return n})();var pe="astro-lenns-db",d="locations",he=1,f=class n{locationsSignal=y([]);locations$=_(()=>this.locationsSignal());constructor(){this.loadAll()}waitForTx(e){return new Promise((t,i)=>{e.oncomplete=()=>t(),e.onerror=()=>i(e.error),e.onabort=()=>i(e.error)})}openDB(){return new Promise((e,t)=>{let i=indexedDB.open(pe,he);i.onupgradeneeded=()=>{let a=i.result;a.objectStoreNames.contains(d)||a.createObjectStore(d,{keyPath:"id",autoIncrement:!0})},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async tx(e,t){let a=(await this.openDB()).transaction(d,e);return t(a.objectStore(d)),await this.waitForTx(a)}async saveNewLocation(e){await this.tx("readwrite",t=>t.add(e)),await this.loadAll()}async editLocation(e,t){let a=(await this.openDB()).transaction(d,"readwrite"),k=a.objectStore(d),F=k.get(e);F.onsuccess=()=>{k.put(S(S({},F.result),t))},await this.waitForTx(a),await this.loadAll()}async deleteLocation(e){await this.tx("readwrite",t=>t.delete(e)),await this.loadAll()}async loadAll(){let a=(await this.openDB()).transaction(d,"readonly").objectStore(d).getAll();a.onsuccess=()=>this.locationsSignal.set(a.result)}async shareLocation(e){let t=`https://maps.google.com/?q=${e.latitude},${e.longitude}`,i=e.address?e.address:e.name;navigator.share?navigator.share({title:e.name,text:`Check out this location: ${i}`,url:t}).catch(()=>window.open(t,"_blank")):window.open(t,"_blank")}openInMaps(e){let t=`https://maps.google.com/?q=${e.latitude},${e.longitude}`;window.open(t,"_blank")}async importLocationFromUrl(e){let t=this.extractCoordinates(e);t&&await this.saveNewLocation({name:"Imported location",type:"Other",latitude:t.lat,longitude:t.lng,isDefault:!1,tags:["Imported"]})}extractCoordinates(e){let t=e.match(/q=(-?\d+.\d+),(-?\d+.\d+)/);return t?{lat:parseFloat(t[1]),lng:parseFloat(t[2])}:null}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};function _e(n,e){if(n&1&&(r(0,"span",14),o(1),s()),n&2){let t=e.$implicit;l(),C(" #",t," ")}}function fe(n,e){if(n&1&&(r(0,"span",15),o(1),s()),n&2){let t=h();l(),C(" +",t.location().tags.length-2," ")}}function be(n,e){if(n&1){let t=x();r(0,"button",22),g("click",function(){b(t);let a=h();return v(a.setAsDefault())}),r(1,"span",21),o(2,"star"),s(),o(3," Set Default "),s()}}function ve(n,e){n&1&&(r(0,"div",19)(1,"span",23),o(2,"verified"),s(),r(3,"span",24),o(4,"Default"),s()())}var L=class n{service=D(f);location=Q.required();typeIconMap={Home:"home",Work:"work",Temple:"temple_hindu",Other:"location_on"};icon=_(()=>this.typeIconMap[this.location().type]);share(){this.service.shareLocation(this.location())}delete(){this.service.deleteLocation(this.location().id)}openInMaps(){this.service.openInMaps(this.location())}setAsDefault(){}shareLocation(){}deleteLoc(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-location-card"]],inputs:{location:[1,"location"]},decls:37,vars:19,consts:[[1,"relative","p-5","bg-white","rounded-[1.5rem]","border","border-slate-100","shadow-sm","active:bg-slate-50","transition-all","duration-200"],[1,"flex","items-start","gap-4","mb-2"],[1,"w-12","h-12","rounded-2xl","flex","items-center","justify-center","shrink-0"],[1,"material-symbols-rounded","text-xl"],[1,"flex-grow","min-w-0"],[1,"font-headings","font-semibold","text-lg","truncate","pr-2"],[1,"flex","items-center","gap-1","text-[9px]","font-sans","font-bold","text-slate-600","py-2"],[1,"material-symbols-rounded","text-[14px]"],[1,"flex","items-center","gap-1","shrink-0"],[1,"cursor-pointer","w-9","h-9","flex","items-center","justify-center","rounded-full","text-red-400","active:scale-90","transition-transform",3,"click"],[1,"material-symbols-rounded","text-[20px]"],[1,"mb-4","pr-2"],[1,"text-xs","text-secondary","font-sans","leading-relaxed","line-clamp-2","min-h-[2.4rem]","opacity-80"],[1,"flex","flex-wrap","gap-1.5","mt-1.5"],[1,"px-2","py-0.5","bg-slate-100","text-[9px]","font-bold","text-slate-500","rounded","uppercase","tracking-tight"],[1,"px-2","py-0.5","bg-primary/5","text-[9px]","font-bold","text-primary","rounded","uppercase"],[1,"flex","items-center","justify-between","pt-3","border-t-2","border-slate-50"],[1,"flex","items-center","gap-2"],[1,"flex","items-center","gap-1.5","px-3","py-2","bg-slate-100","text-slate-600","rounded-xl","text-[11px]","font-bold","active:bg-primary/10","active:text-primary","transition-all"],[1,"flex","items-center","gap-1.5","px-3","py-2","bg-primary/10","text-primary","rounded-xl"],[1,"cursor-pointer","flex","items-center","gap-1.5","px-3","py-2","bg-primary","text-primary","rounded-xl","text-[11px]","font-semibold","active:scale-95","transition-transform",3,"click"],[1,"material-symbols-rounded","text-sm"],[1,"flex","items-center","gap-1.5","px-3","py-2","bg-slate-100","text-slate-600","rounded-xl","text-[11px]","font-bold","active:bg-primary/10","active:text-primary","transition-all",3,"click"],[1,"material-symbols-rounded","text-sm","active"],[1,"text-[10px]","font-black","uppercase","tracking-wider"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),o(4),s()(),r(5,"div",4)(6,"h3",5),o(7),s(),r(8,"div",6)(9,"span",7),o(10,"explore"),s(),o(11),s()(),r(12,"div",8)(13,"button",9),g("click",function(){return i.delete()}),r(14,"span",10),o(15,"delete_outline"),s()()()(),r(16,"div",11)(17,"p",12),o(18),s(),r(19,"div",13),E(20,_e,2,1,"span",14,H),X(22,"slice"),u(23,fe,2,1,"span",15),s()(),r(24,"div",16)(25,"div",17),u(26,be,4,0,"button",18)(27,ve,5,0,"div",19),s(),r(28,"div",17)(29,"button",20),g("click",function(){return i.share()}),r(30,"span",21),o(31,"ios_share"),s(),o(32," Share "),s(),r(33,"button",20),g("click",function(){return i.openInMaps()}),r(34,"span",21),o(35,"map"),s(),o(36," view Map "),s()()()()),t&2&&(l(2),T("bg-blue-600",i.location().isDefault)("bg-slate-200",!i.location().isDefault),l(),T("text-white",i.location().isDefault)("text-slate-400",!i.location().isDefault),l(),C(" ",i.icon()," "),l(3),V(i.location().name),l(4),Y(" ",i.location().latitude.toFixed(3),", ",i.location().longitude.toFixed(3)," "),l(7),C(" ",i.location().address," "),l(2),I(z(22,15,i.location().tags,0,2)),l(3),p(i.location().tags.length>2?23:-1),l(3),p(i.location().isDefault?26:27))},dependencies:[$],encapsulation:2})};var ye=(n,e)=>e.id;function Me(n,e){if(n&1){let t=x();m(0,"button",12),w("click",function(){b(t);let a=h();return v(a.searchQuery.set(""))}),o(1," close "),c()}}function xe(n,e){n&1&&(m(0,"div",10)(1,"span",13),o(2," location_off "),c(),m(3,"div")(4,"p",14),o(5,"No locations saved"),c(),m(6,"p",15),o(7,"Add your home, work or favorite places"),c()()())}function we(n,e){n&1&&(m(0,"div",10)(1,"span",13),o(2," search_off "),c(),m(3,"div")(4,"p",14),o(5,"No results found"),c(),m(6,"p",15),o(7,"Try a different name or tag"),c()()())}function Ce(n,e){if(n&1&&O(0,"app-location-card",16),n&2){let t=e.$implicit;P("location",t)}}function ke(n,e){if(n&1&&(m(0,"div",11),E(1,Ce,1,1,"app-location-card",16,ye),c()),n&2){let t=h();l(),I(t.locations())}}var ue=class n{showSearch=y(!1);searchQuery=y("");service=D(f);allLocations=this.service.locations$;locations=_(()=>{let e=this.searchQuery().trim().toLowerCase();return e?this.allLocations().filter(t=>t.name.toLowerCase().includes(e)||t.address?.toLowerCase().includes(e)||t.tags?.some(i=>i.toLowerCase().includes(e))||t.type.toLowerCase().includes(e)):this.allLocations()});ngAfterViewInit(){}deleteLoc(e){}setAsDefault(e){}toggleSearch(){this.showSearch.set(!this.showSearch()),this.showSearch()||this.searchQuery.set("")}addLocation(){this.service.saveNewLocation({name:"Bantumilli, Krishna, AP sdlfjalksdfl;ka weiplsakdnlkasflk",type:"Other",latitude:16.2833,longitude:80.8667,tags:["Village","Hometown"],isDefault:!1})}openInMaps(e){let t=`www.google.com{loc.lat},${e.lng}`;navigator.share?navigator.share({title:e.name,text:`Check out this location: ${e.address}`,url:t}).catch(()=>window.open(t,"_blank")):window.open(t,"_blank")}shareLocation(e){let t=`https://www.google.com/maps?q=${e.lat},${e.lng}`;navigator.share?navigator.share({title:e.name,text:e.address,url:t}):navigator.clipboard.writeText(t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-saved-locations-page"]],decls:18,vars:3,consts:[[1,"absolute","right-6","bottom-26","z-10"],[1,"p-4","bg-blue-600","text-white","rounded-full","shadow-lg","active:scale-95","transition-transform","flex","items-center","justify-center",3,"click"],[1,"material-symbols-rounded"],["header","",1,"flex","flex-col","header-padding","gap-6"],[1,"page-heading"],["appearance","outline",1,"w-full"],["matPrefix","",1,"material-symbols-rounded","px-4"],["matInput","","placeholder","Search locations",3,"ngModelChange","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear",1,"material-symbols-rounded","px-4"],[1,"py-6","flex","flex-col","flex-grow","overflow-y-auto","pb-16"],[1,"flex","flex-col","items-center","justify-center","text-center","gap-4","mt-16","text-gray-500"],[1,"flex","flex-col","gap-4"],["matSuffix","","mat-icon-button","","aria-label","Clear",1,"material-symbols-rounded","px-4",3,"click"],[1,"material-symbols-rounded","text-5xl","text-gray-300","bg-gray-100","rounded-full","p-4"],[1,"text-lg","font-medium"],[1,"text-sm"],[3,"location"]],template:function(t,i){t&1&&(m(0,"app-container")(1,"div",0)(2,"button",1),w("click",function(){return i.addLocation()}),m(3,"span",2),o(4,"add_location_alt"),c()()(),m(5,"section",3)(6,"h1",4),o(7,"Locations"),c(),m(8,"div")(9,"mat-form-field",5)(10,"span",6),o(11,"search"),c(),m(12,"input",7),w("ngModelChange",function(k){return i.searchQuery.set(k)}),c(),u(13,Me,2,0,"button",8),c()()(),m(14,"section",9),u(15,xe,8,0,"div",10)(16,we,8,0,"div",10)(17,ke,3,0,"div",11),c()()),t&2&&(l(12),P("ngModel",i.searchQuery()),l(),p(i.searchQuery()?13:-1),l(2),p(i.locations().length===0&&!i.searchQuery()?15:i.locations().length===0&&i.searchQuery()?16:17))},dependencies:[ne,ee,te,ie,q,W,R,de,se,re,oe,ae,me,le,ce,G,U,L],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.self-end[_ngcontent-%COMP%]{align-self:flex-end}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}.animate-slideDown[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .15s ease-out}"]})};export{ue as SavedLocationsPage};
